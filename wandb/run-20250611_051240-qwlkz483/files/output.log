Using device: cuda
20 samples have been processed.

X_train shape: (20, 4800)
y_train shape: (20, 2)
Dataset size:  20
Starting training...
Epoch 1 Summary: Train Loss: 2.775581, Val Loss: 1.307771
Saving current best: model_best.pth ...
Epoch 2 Summary: Train Loss: 2.692291, Val Loss: 1.245656
Saving current best: model_best.pth ...
Epoch 3 Summary: Train Loss: 2.619503, Val Loss: 1.165761
Saving current best: model_best.pth ...
Epoch 4 Summary: Train Loss: 2.551634, Val Loss: 1.076412
Saving current best: model_best.pth ...
Epoch 5 Summary: Train Loss: 2.487589, Val Loss: 0.982158
Saving current best: model_best.pth ...
Epoch 6 Summary: Train Loss: 2.428158, Val Loss: 0.887276
Saving current best: model_best.pth ...
Epoch 7 Summary: Train Loss: 2.373289, Val Loss: 0.795949
Saving current best: model_best.pth ...
Epoch 8 Summary: Train Loss: 2.322560, Val Loss: 0.718644
Saving current best: model_best.pth ...
Epoch 9 Summary: Train Loss: 2.275078, Val Loss: 0.660882
Saving current best: model_best.pth ...
Epoch 10 Summary: Train Loss: 2.230120, Val Loss: 0.627824
Saving current best: model_best.pth ...
Epoch 11 Summary: Train Loss: 2.187285, Val Loss: 0.602280
Saving current best: model_best.pth ...
Epoch 12 Summary: Train Loss: 2.146536, Val Loss: 0.570727
Saving current best: model_best.pth ...
Epoch 13 Summary: Train Loss: 2.107861, Val Loss: 0.521405
Saving current best: model_best.pth ...
Epoch 14 Summary: Train Loss: 2.071177, Val Loss: 0.465454
Saving current best: model_best.pth ...
Epoch 15 Summary: Train Loss: 2.036277, Val Loss: 0.416842
Saving current best: model_best.pth ...
Epoch 16 Summary: Train Loss: 2.002975, Val Loss: 0.386576
Saving current best: model_best.pth ...
Epoch 17 Summary: Train Loss: 1.971162, Val Loss: 0.372777
Saving current best: model_best.pth ...
Epoch 18 Summary: Train Loss: 1.940759, Val Loss: 0.365778
Saving current best: model_best.pth ...
Epoch 19 Summary: Train Loss: 1.911706, Val Loss: 0.361735
Saving current best: model_best.pth ...
Epoch 20 Summary: Train Loss: 1.883909, Val Loss: 0.358884
Saving current best: model_best.pth ...
Epoch 21 Summary: Train Loss: 1.857262, Val Loss: 0.357768
Saving current best: model_best.pth ...
Epoch 22 Summary: Train Loss: 1.831666, Val Loss: 0.357922
Epoch 23 Summary: Train Loss: 1.807035, Val Loss: 0.357322
Saving current best: model_best.pth ...
Epoch 24 Summary: Train Loss: 1.783312, Val Loss: 0.355773
Saving current best: model_best.pth ...
Epoch 25 Summary: Train Loss: 1.760455, Val Loss: 0.354075
Traceback (most recent call last):
  File "/Workspace/Users/stucbk953-mmm@g.ecc.u-tokyo.ac.jp/CLIP/scripts/train.py", line 161, in <module>
    train(config_data) # train関数に読み込んだ辞書を渡す
    ^^^^^^^^^^^^^^^^^^
  File "/Workspace/Users/stucbk953-mmm@g.ecc.u-tokyo.ac.jp/CLIP/scripts/train.py", line 117, in train
    trainer.train()
  File "/Workspace/Users/stucbk953-mmm@g.ecc.u-tokyo.ac.jp/CLIP/base/base_trainer.py", line 100, in train
    self._save_checkpoint(epoch, save_best=best)
  File "/Workspace/Users/stucbk953-mmm@g.ecc.u-tokyo.ac.jp/CLIP/base/base_trainer.py", line 120, in _save_checkpoint
    torch.save(state, filename)
  File "/databricks/python/lib/python3.11/site-packages/torch/serialization.py", line 627, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/databricks/python/lib/python3.11/site-packages/torch/serialization.py", line 475, in __exit__
    self.file_like.write_end_of_file()
KeyboardInterrupt
